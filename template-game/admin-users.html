<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Usuarios - GGDeals</title>

    <!-- Enlaces CSS -->
    <link rel="shortcut icon" href="./assets/compiled/svg/favicon.svg" type="image/x-icon">
    <link rel="stylesheet" href="./assets/compiled/css/app.css">
    <link rel="stylesheet" href="./assets/compiled/css/app-dark.css">
    <link rel="stylesheet" href="./assets/compiled/css/iconly.css">
    <link rel="stylesheet" href="./assets/extensions/datatables.net-bs5/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="./assets/compiled/css/table-datatable-jquery.css">
    <link rel="stylesheet" href="./assets/extensions/bootstrap-icons/font/bootstrap-icons.css">
</head>

<body>
    <script src="./assets/static/js/initTheme.js"></script>
    <div id="app">
        <div id="main" class="layout-horizontal">
            <header class="mb-5">
                <div class="header-top">
                    <div class="container">
                        <div class="logo">
                            <a href="admin.html"><img src="./assets/compiled/svg/logo.svg" alt="Logo"> </a>
                        </div>
                        <div class="header-top-right">
                            <div class="dropdown">
                                <a href="#" id="topbarUserDropdown"
                                    class="user-dropdown d-flex align-items-center dropend dropdown-toggle "
                                    data-bs-toggle="dropdown" aria-expanded="false">
                                    <div class="avatar avatar-md2">
                                        <img src="./assets/compiled/jpg/1.jpg" alt="Avatar">
                                    </div>
                                    <div class="text">
                                        <h6 class="user-dropdown-name">Administrador</h6>
                                        <p class="user-dropdown-status text-sm text-muted">Administrador</p>
                                    </div>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end shadow-lg"
                                    aria-labelledby="topbarUserDropdown">
                                    <li><a class="dropdown-item" href="admin-profile.html">Mi Perfil</a></li>
                                    <li><a class="dropdown-item" href="admin-password.html">Cambiar Contraseña</a></li>
                                    <li>
                                        <hr class="dropdown-divider">
                                    </li>
                                    <li><a class="dropdown-item" href="login.html">Cerrar Sesión</a></li>
                                </ul>
                            </div>

                            <!-- Burger button responsive -->
                            <a href="#" class="burger-btn d-block d-xl-none">
                                <i class="bi bi-justify fs-3"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <nav class="main-navbar">
                    <div class="container">
                        <ul>
                            <li class="menu-item">
                                <a href="admin.html" class='menu-link'>
                                    <span><i class="bi bi-grid-fill"></i> Dashboard</span>
                                </a>
                            </li>

                            <li class="menu-item active">
                                <a href="admin-users.html" class='menu-link'>
                                    <span><i class="bi bi-people-fill"></i> Usuarios</span>
                                </a>
                            </li>

                            <li class="menu-item">
                                <a href="admin-games.html" class='menu-link'>
                                    <span><i class="bi bi-joystick"></i> Videojuegos</span>
                                </a>
                            </li>

                            <li class="menu-item">
                                <a href="admin-keys.html" class='menu-link'>
                                    <span><i class="bi bi-key-fill"></i> Réplicas</span>
                                </a>
                            </li>

                            <li class="menu-item">
                                <a href="admin-sales.html" class='menu-link'>
                                    <span><i class="bi bi-cart-fill"></i> Ventas</span>
                                </a>
                            </li>

                            <li class="menu-item">
                                <a href="admin-reservations.html" class='menu-link'>
                                    <span><i class="bi bi-bookmark-fill"></i> Reservas</span>
                                </a>
                            </li>

                            <li class="menu-item has-sub">
                                <a href="#" class='menu-link'>
                                    <span><i class="bi bi-list-check"></i> Catálogos</span>
                                </a>
                                <div class="submenu">
                                    <div class="submenu-group-wrapper">
                                        <ul class="submenu-group">
                                            <li class="submenu-item">
                                                <a href="admin-platforms.html" class='submenu-link'>Plataformas</a>
                                            </li>
                                            <li class="submenu-item">
                                                <a href="admin-editions.html" class='submenu-link'>Ediciones</a>
                                            </li>
                                            <li class="submenu-item">
                                                <a href="admin-features.html" class='submenu-link'>Características</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </header>

            <div class="content-wrapper container">

                <div class="page-heading">
                    <div class="d-flex justify-content-between">
                        <h3>Gestión de Usuarios</h3>
                        <a href="#" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addUserModal">
                            <i class="bi bi-plus"></i> Nuevo Usuario
                        </a>
                    </div>
                </div>
                <div class="page-content">
                    <section class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h4>Lista de Usuarios</h4>
                                        <div class="btn-group" role="group">
                                            <button type="button" class="btn btn-sm btn-outline-primary active"
                                                id="filter-all">Todos</button>
                                            <button type="button" class="btn btn-sm btn-outline-primary"
                                                id="filter-customers">Clientes</button>
                                            <button type="button" class="btn btn-sm btn-outline-primary"
                                                id="filter-admins">Administradores</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-striped" id="usersTable">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>Nombre Usuario</th>
                                                    <th>Email</th>
                                                    <th>Rol</th>
                                                    <th>Fecha Verificación</th>
                                                    <th>Estado</th>
                                                    <th>Acciones</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>1</td>
                                                    <td>admin</td>
                                                    <td>admin@ggdeals.com</td>
                                                    <td>Administrador</td>
                                                    <td>01/01/2025</td>
                                                    <td><span class="badge bg-success">Activo</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="1"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="1"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-danger" href="#" data-bs-toggle="modal" data-bs-target="#deactivateUserModal" data-id="1"><i class="bi bi-slash-circle"></i> Desactivar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>2</td>
                                                    <td>miguel</td>
                                                    <td>miguel@example.com</td>
                                                    <td>Cliente</td>
                                                    <td>15/01/2025</td>
                                                    <td><span class="badge bg-success">Activo</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="2"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="2"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-danger" href="#" data-bs-toggle="modal" data-bs-target="#deactivateUserModal" data-id="2"><i class="bi bi-slash-circle"></i> Desactivar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>3</td>
                                                    <td>laura</td>
                                                    <td>laura@example.com</td>
                                                    <td>Cliente</td>
                                                    <td>20/01/2025</td>
                                                    <td><span class="badge bg-success">Activo</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="3"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="3"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-danger" href="#" data-bs-toggle="modal" data-bs-target="#deactivateUserModal" data-id="3"><i class="bi bi-slash-circle"></i> Desactivar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>4</td>
                                                    <td>carlos</td>
                                                    <td>carlos@example.com</td>
                                                    <td>Cliente</td>
                                                    <td>05/02/2025</td>
                                                    <td><span class="badge bg-success">Activo</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="4"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="4"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-danger" href="#" data-bs-toggle="modal" data-bs-target="#deactivateUserModal" data-id="4"><i class="bi bi-slash-circle"></i> Desactivar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>5</td>
                                                    <td>elena</td>
                                                    <td>elena@example.com</td>
                                                    <td>Cliente</td>
                                                    <td>10/02/2025</td>
                                                    <td><span class="badge bg-success">Activo</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="5"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="5"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-danger" href="#" data-bs-toggle="modal" data-bs-target="#deactivateUserModal" data-id="5"><i class="bi bi-slash-circle"></i> Desactivar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>6</td>
                                                    <td>javier</td>
                                                    <td>javier@example.com</td>
                                                    <td>Cliente</td>
                                                    <td>15/02/2025</td>
                                                    <td><span class="badge bg-success">Activo</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="6"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="6"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-danger" href="#" data-bs-toggle="modal" data-bs-target="#deactivateUserModal" data-id="6"><i class="bi bi-slash-circle"></i> Desactivar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>7</td>
                                                    <td>ana</td>
                                                    <td>ana@example.com</td>
                                                    <td>Cliente</td>
                                                    <td>-</td>
                                                    <td><span class="badge bg-warning">Pendiente</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="7"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="7"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-danger" href="#" data-bs-toggle="modal" data-bs-target="#deactivateUserModal" data-id="7"><i class="bi bi-slash-circle"></i> Desactivar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>8</td>
                                                    <td>marta</td>
                                                    <td>marta@example.com</td>
                                                    <td>Cliente</td>
                                                    <td>01/03/2025</td>
                                                    <td><span class="badge bg-danger">Desactivado</span></td>
                                                    <td>
                                                        <div class="dropdown">
                                                            <button class="btn btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <i class="bi bi-three-dots-vertical"></i>
                                                            </button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#viewUserModal" data-id="8"><i class="bi bi-eye"></i> Ver detalle</a></li>
                                                                <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#editUserModal" data-id="8"><i class="bi bi-pencil"></i> Editar</a></li>
                                                                <li><hr class="dropdown-divider"></li>
                                                                <li><a class="dropdown-item text-success" href="#" data-bs-toggle="modal" data-bs-target="#activateUserModal" data-id="8"><i class="bi bi-check-circle"></i> Activar</a></li>
                                                            </ul>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <footer>
                <div class="container">
                    <div class="footer clearfix mb-0 text-muted">
                        <div class="float-start">
                            <p>2025 &copy; GGDeals Admin</p>
                        </div>

                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Modal para agregar usuario -->
    <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addUserModalLabel">Agregar Nuevo Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addUserForm">
                        <div class="mb-3">
                            <label for="userName" class="form-label">Nombre de usuario</label>
                            <input type="text" class="form-control" id="userName" required>
                        </div>
                        <div class="mb-3">
                            <label for="userEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="userEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="userPassword" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="userPassword" required>
                        </div>
                        <div class="mb-3">
                            <label for="userRole" class="form-label">Rol</label>
                            <select class="form-select" id="userRole" required>
                                <option value="">Seleccionar rol</option>
                                <option value="Cliente">Cliente</option>
                                <option value="Administrador">Administrador</option>
                            </select>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="userVerified">
                            <label class="form-check-label" for="userVerified">
                                Email verificado
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveUserBtn">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar usuario -->
    <div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editUserModalLabel">Editar Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editUserForm">
                        <input type="hidden" id="editUserId">
                        <div class="mb-3">
                            <label for="editUserName" class="form-label">Nombre de usuario</label>
                            <input type="text" class="form-control" id="editUserName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editUserEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="editUserEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="editUserRole" class="form-label">Rol</label>
                            <select class="form-select" id="editUserRole" required>
                                <option value="Cliente">Cliente</option>
                                <option value="Administrador">Administrador</option>
                            </select>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="editUserVerified">
                            <label class="form-check-label" for="editUserVerified">
                                Email verificado
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="editUserActive">
                            <label class="form-check-label" for="editUserActive">
                                Usuario activo
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="updateUserBtn">Actualizar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para ver detalles de usuario -->
    <div class="modal fade" id="viewUserModal" tabindex="-1" aria-labelledby="viewUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewUserModalLabel">Detalles del Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <div class="avatar avatar-xl mb-3">
                            <img src="assets/compiled/jpg/1.jpg" alt="Avatar">
                        </div>
                        <h4 id="viewUserName">Nombre del Usuario</h4>
                        <p class="text-muted" id="viewUserRole">Rol del Usuario</p>
                    </div>
                    <div class="row">
                        <div class="col-4 text-end fw-bold">ID:</div>
                        <div class="col-8" id="viewUserId"></div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-4 text-end fw-bold">Email:</div>
                        <div class="col-8" id="viewUserEmail"></div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-4 text-end fw-bold">Fecha Verificación:</div>
                        <div class="col-8" id="viewUserVerified"></div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-4 text-end fw-bold">Estado:</div>
                        <div class="col-8" id="viewUserStatus"></div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-4 text-end fw-bold">Registro:</div>
                        <div class="col-8" id="viewUserRegistration"></div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-4 text-end fw-bold">Última conexión:</div>
                        <div class="col-8" id="viewUserLastLogin"></div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-12">
                            <h6>Historial de compras</h6>
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Juego</th>
                                            <th>Fecha</th>
                                            <th>Importe</th>
                                        </tr>
                                    </thead>
                                    <tbody id="userPurchaseHistory">
                                        <!-- Se llena dinámicamente -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para desactivar usuario -->
    <div class="modal fade" id="deactivateUserModal" tabindex="-1" aria-labelledby="deactivateUserModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deactivateUserModalLabel">Desactivar Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>¿Estás seguro de que deseas desactivar al usuario <span id="deactivateUserName"
                            class="fw-bold"></span>?</p>
                    <p>El usuario no podrá acceder a su cuenta mientras esté desactivado.</p>
                    <input type="hidden" id="deactivateUserId">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmDeactivateBtn">Desactivar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para activar usuario -->
    <div class="modal fade" id="activateUserModal" tabindex="-1" aria-labelledby="activateUserModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="activateUserModalLabel">Activar Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>¿Estás seguro de que deseas activar al usuario <span id="activateUserName"
                            class="fw-bold"></span>?</p>
                    <p>El usuario podrá acceder a su cuenta nuevamente.</p>
                    <input type="hidden" id="activateUserId">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-success" id="confirmActivateBtn">Activar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="./assets/static/js/components/dark.js"></script>
    <script src="./assets/extensions/perfect-scrollbar/perfect-scrollbar.min.js"></script>
    <script src="./assets/static/js/pages/horizontal-layout.js"></script>
    <script src="./assets/compiled/js/app.js"></script>
    <script src="./assets/extensions/jquery/jquery.min.js"></script>
    <script src="./assets/extensions/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="./assets/extensions/datatables.net-bs5/js/dataTables.bootstrap5.min.js"></script>

    <script>
        $(document).ready(function () {
            // Inicializar DataTable
            var table = $('#usersTable').DataTable({
                "language": {
                    "url": "//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json"
                }
            });

            // Filtros de roles
            $('#filter-all').click(function () {
                table.column(4).search('').draw();
                $('.btn-outline-primary').removeClass('active');
                $(this).addClass('active');
            });

            $('#filter-customers').click(function () {
                table.column(4).search('Cliente').draw();
                $('.btn-outline-primary').removeClass('active');
                $(this).addClass('active');
            });

            $('#filter-admins').click(function () {
                table.column(4).search('Administrador').draw();
                $('.btn-outline-primary').removeClass('active');
                $(this).addClass('active');
            });

            // Cargar datos en modal de edición
            $('#editUserModal').on('show.bs.modal', function (event) {
                var button = $(event.relatedTarget);
                var id = button.data('id');
                var name = button.data('name');
                var email = button.data('email');
                var role = button.data('role');

                $('#editUserId').val(id);
                $('#editUserName').val(name);
                $('#editUserEmail').val(email);
                $('#editUserRole').val(role);
                $('#editUserVerified').prop('checked', true);
                $('#editUserActive').prop('checked', true);
            });

            // Cargar datos en modal de vista
            $('#viewUserModal').on('show.bs.modal', function (event) {
                var button = $(event.relatedTarget);
                var id = button.data('id');
                var name = button.data('name');
                var email = button.data('email');
                var role = button.data('role');

                $('#viewUserId').text(id);
                $('#viewUserName').text(name);
                $('#viewUserEmail').text(email);
                $('#viewUserRole').text(role);
                $('#viewUserStatus').html('<span class="badge bg-success">Activo</span>');
                $('#viewUserVerified').html('<span class="badge bg-success">Sí</span>');
                $('#viewUserRegistration').text('01/01/2025');
                $('#viewUserLastLogin').text('14/05/2025');

                // Limpiar y cargar historial de compras
                $('#userPurchaseHistory').empty();
                if (id == 2) {
                    $('#userPurchaseHistory').append(`
                        <tr>
                            <td>#84253</td>
                            <td>The Last of Us Part II</td>
                            <td>14/05/2025</td>
                            <td>€59.99</td>
                        </tr>
                        <tr>
                            <td>#82149</td>
                            <td>Cyberpunk 2077</td>
                            <td>02/04/2025</td>
                            <td>€39.99</td>
                        </tr>
                    `);
                } else if (id == 3) {
                    $('#userPurchaseHistory').append(`
                        <tr>
                            <td>#84252</td>
                            <td>FIFA 25</td>
                            <td>14/05/2025</td>
                            <td>€69.99</td>
                        </tr>
                    `);
                } else if (id == 4) {
                    $('#userPurchaseHistory').append(`
                        <tr>
                            <td>#84251</td>
                            <td>Hogwarts Legacy</td>
                            <td>13/05/2025</td>
                            <td>€49.99</td>
                        </tr>
                    `);
                } else {
                    $('#userPurchaseHistory').append(`
                        <tr>
                            <td colspan="4" class="text-center">No hay compras registradas</td>
                        </tr>
                    `);
                }
            });

            // Cargar datos en modal de desactivación
            $('#deactivateUserModal').on('show.bs.modal', function (event) {
                var button = $(event.relatedTarget);
                var id = button.data('id');
                var name = button.data('name');

                $('#deactivateUserId').val(id);
                $('#deactivateUserName').text(name);
            });

            // Cargar datos en modal de activación
            $('#activateUserModal').on('show.bs.modal', function (event) {
                var button = $(event.relatedTarget);
                var id = button.data('id');
                var name = button.data('name');

                $('#activateUserId').val(id);
                $('#activateUserName').text(name);
            });

            // Guardar nuevo usuario
            $('#saveUserBtn').click(function () {
                if ($('#addUserForm')[0].checkValidity()) {
                    alert('Usuario creado correctamente');
                    $('#addUserModal').modal('hide');
                    $('#addUserForm')[0].reset();
                } else {
                    $('#addUserForm')[0].reportValidity();
                }
            });

            // Actualizar usuario
            $('#updateUserBtn').click(function () {
                if ($('#editUserForm')[0].checkValidity()) {
                    alert('Usuario actualizado correctamente');
                    $('#editUserModal').modal('hide');
                } else {
                    $('#editUserForm')[0].reportValidity();
                }
            });

            // Desactivar usuario
            $('#confirmDeactivateBtn').click(function () {
                alert('Usuario desactivado correctamente');
                $('#deactivateUserModal').modal('hide');
            });

            // Activar usuario
            $('#confirmActivateBtn').click(function () {
                alert('Usuario activado correctamente');
                $('#activateUserModal').modal('hide');
            });
        });
    </script>
</body>

</html>